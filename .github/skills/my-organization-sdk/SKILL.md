# MyOrganization JS SDK - Agent Guidelines

**Version 1.0.0**
Auth0 Engineering
February 2026

> **Note:**
> This document is for AI agents and LLMs to follow when maintaining,
> contributing to, or working with the @auth0/myorganization-js SDK.
> It contains critical information about generated code, testing patterns,
> and development workflows.

---

## Abstract

The @auth0/myorganization-js SDK is a TypeScript client for managing Auth0 organizations, members, roles, and domains. **Most of the codebase is auto-generated by Fern** from API specifications. This guide helps AI agents understand the codebase structure, identify what can be modified, and follow proper contribution workflows.

---

## Table of Contents

1. [Critical Information](#1-critical-information) - **READ FIRST**
2. [Project Overview](#2-project-overview)
3. [Architecture](#3-architecture)
4. [Development Workflow](#4-development-workflow)
5. [Testing Guidelines](#5-testing-guidelines)
6. [Code Patterns](#6-code-patterns)
7. [Common Tasks](#7-common-tasks)
8. [API Reference](#8-api-reference)
9. [Integration with auth0-ui-components](#9-integration-with-auth0-ui-components) - **CONSUMER REFERENCE**

---

## 1. Critical Information

**Impact: CRITICAL - Read before making any changes**

### 1.1 Generated Code Warning

**MOST FILES IN THIS SDK ARE AUTO-GENERATED BY FERN.**

The following directories contain generated code that **WILL BE OVERWRITTEN**:

- `src/api/` - API client classes and types
- `src/api/resources/` - Resource-specific endpoints
- `src/api/types/` - TypeScript type definitions
- `src/api/errors/` - Error classes
- `src/core/` - Core utilities
- `src/errors/` - Error handling
- `src/wrappers/` - API wrappers

**Do NOT directly modify these files** unless the changes are tracked in `.fernignore`.

### 1.2 Safe to Modify

These files/directories CAN be safely modified:

- `README.md` - Documentation
- `CONTRIBUTING.md` - Contribution guidelines
- `tests/` - Test files
- `example.ts` - Usage examples
- `.github/` - CI/CD workflows
- Configuration files (`tsconfig.*.json`, `eslint.config.mjs`, etc.)
- Files listed in `.fernignore`

### 1.3 Customization Approach

To add custom code that persists across regenerations:

1. Add file patterns to `.fernignore`
2. Create custom files in those locations
3. Files in `.fernignore` will NOT be overwritten during SDK regeneration

---

## 2. Project Overview

### 2.1 Purpose

The SDK provides a TypeScript client for Auth0's MyOrganization API, enabling:

- Organization management
- Member management
- Role assignments
- Domain configuration
- Identity provider settings

### 2.2 Package Information

```json
{
  "name": "@auth0/myorganization-js",
  "main": "./dist/cjs/index.js",
  "module": "./dist/esm/index.mjs",
  "types": "./dist/cjs/index.d.ts"
}
```

### 2.3 Entry Points

| Entry Point | Description |
|-------------|-------------|
| `@auth0/myorganization-js` | Main client for browser/Node.js |
| `@auth0/myorganization-js/server` | Server-side utilities with client credentials |

### 2.4 Runtime Support

- Node.js 18+
- Vercel Edge Functions
- Cloudflare Workers
- Deno v1.25+
- Bun 1.0+
- React Native

---

## 3. Architecture

### 3.1 Directory Structure

```
src/
├── Client.ts           # Main client class
├── BaseClient.ts       # Base client with HTTP utilities
├── index.ts            # Public exports
├── server.ts           # Server-side exports
├── environments.ts     # Environment configuration
├── version.ts          # SDK version
├── api/
│   ├── index.ts        # API exports
│   ├── errors/         # API error classes
│   ├── requests/       # Request type definitions
│   ├── resources/      # Resource clients (organizations, members, etc.)
│   └── types/          # Type definitions
├── auth/               # Authentication utilities
├── core/               # Core HTTP/serialization utilities
├── errors/             # Error handling
├── utils/              # Utility functions
└── wrappers/           # API response wrappers
```

### 3.2 Client Architecture

```typescript
// Main client initialization
const client = new MyOrganizationClient({
    domain: "tenant.region.auth0.com",
    token: "ACCESS_TOKEN",  // or token supplier function
});

// Resource access pattern
client.organization.members.list();
client.organization.domains.create({ domain: "example.com" });
client.organization.roles.assign({ userId: "user_123", roleId: "role_456" });
```

### 3.3 Authentication Patterns

**Static Token:**
```typescript
const client = new MyOrganizationClient({
    domain: "tenant.auth0.com",
    token: "static_access_token",
});
```

**Token Supplier (Recommended):**
```typescript
const client = new MyOrganizationClient({
    domain: "tenant.auth0.com",
    token: async ({ scope }) => {
        return await getAccessToken({ scope });
    },
});
```

**Client Credentials (Server-side):**
```typescript
import { createMyOrganizationClientWithClientCredentials } from "@auth0/myorganization-js/server";

const client = createMyOrganizationClientWithClientCredentials(
    { domain: "tenant.auth0.com" },
    { clientId: "...", clientSecret: "...", organization: "org_123" }
);
```

---

## 4. Development Workflow

### 4.1 Prerequisites

- Node.js 20 or higher
- pnpm package manager

### 4.2 Common Commands

| Command | Description |
|---------|-------------|
| `pnpm install` | Install dependencies |
| `pnpm build` | Build CJS and ESM outputs |
| `pnpm test` | Run all tests |
| `pnpm test:unit` | Run unit tests only |
| `pnpm test:wire` | Run wire/integration tests |
| `pnpm lint` | Check code style |
| `pnpm lint:fix` | Fix linting issues |
| `pnpm format` | Format code with Prettier |
| `pnpm format:check` | Check formatting |
| `pnpm check:fix` | Run all checks and auto-fix |
| `pnpm docs` | Generate TypeDoc documentation |

### 4.3 Build Process

The SDK builds to both CommonJS and ESM formats:

```bash
pnpm build:cjs  # TypeScript -> dist/cjs/
pnpm build:esm  # TypeScript -> dist/esm/ (with .mjs extension)
```

### 4.4 Pre-commit Hooks

The project uses Husky with lint-staged:

- TypeScript files: ESLint + Prettier
- JSON/CSS/MD files: Prettier

---

## 5. Testing Guidelines

### 5.1 Test Structure

```
tests/
├── custom.test.ts      # Custom test cases
├── mock-server/        # Mock server setup for wire tests
├── unit/               # Unit tests
├── wire/               # Integration/wire tests
└── tsconfig.json       # Test-specific TypeScript config
```

### 5.2 Test Framework

The SDK uses **Vitest** with **MSW** (Mock Service Worker) for API mocking:

```typescript
import { describe, it, expect } from 'vitest';

describe('MyOrganizationClient', () => {
    it('should list organization members', async () => {
        const client = new MyOrganizationClient({
            domain: 'test.auth0.com',
            token: 'test_token',
        });

        const members = await client.organization.members.list();
        expect(members.data).toBeDefined();
    });
});
```

### 5.3 Running Tests

```bash
# All tests
pnpm test

# Unit tests only (fast, no network)
pnpm test:unit

# Wire tests (with mocked HTTP)
pnpm test:wire

# Watch mode
pnpm test -- --watch
```

---

## 6. Code Patterns

### 6.1 Error Handling

```typescript
import { MyOrganizationClient, MyOrganizationError } from "@auth0/myorganization-js";

try {
    await client.organization.domains.create({ domain: "example.com" });
} catch (err) {
    if (err instanceof MyOrganizationError) {
        console.log(err.statusCode);  // HTTP status code
        console.log(err.message);     // Error message
        console.log(err.body);        // Response body
        console.log(err.rawResponse); // Raw fetch Response
    }
}
```

### 6.2 Pagination

```typescript
let page = await client.organization.members.list({ take: 10 });

// Process first page
console.log(page.data);

// Iterate through pages
while (page.hasNextPage()) {
    page = await page.getNextPage();
    console.log(page.data);
}
```

### 6.3 Request Options

All methods accept optional request options:

```typescript
await client.organization.domains.create(
    { domain: "example.com" },
    {
        headers: { "X-Custom-Header": "value" },
        queryParams: { customParam: "value" },
        maxRetries: 3,
        timeoutInSeconds: 30,
        abortSignal: controller.signal,
    }
);
```

### 6.4 Raw Response Access

```typescript
const { data, rawResponse } = await client.organization.domains
    .create({ domain: "example.com" })
    .withRawResponse();

console.log(rawResponse.headers.get("X-RateLimit-Remaining"));
```

### 6.5 Retry Behavior

The SDK automatically retries on:
- 408 (Timeout)
- 429 (Rate Limited)
- 5xx (Server Errors)

Default: 2 retries with exponential backoff.

---

## 7. Common Tasks

### 7.1 Adding Custom Functionality

1. Add file pattern to `.fernignore`:
   ```
   src/custom/
   ```

2. Create custom module:
   ```typescript
   // src/custom/helpers.ts
   export function customHelper() {
       // Your custom code
   }
   ```

3. Export from index if needed (add to `.fernignore` first)

### 7.2 Updating Documentation

Safe to modify:
- `README.md` - Main documentation
- `reference.md` - API reference (may be generated)
- `CONTRIBUTING.md` - Contribution guide

### 7.3 Adding Tests

Create test files in `tests/unit/` or `tests/wire/`:

```typescript
// tests/unit/my-feature.test.ts
import { describe, it, expect } from 'vitest';

describe('My Feature', () => {
    it('should work correctly', () => {
        // Test implementation
    });
});
```

### 7.4 Fixing Generated Code Issues

If you find bugs in generated code:

1. **Do NOT fix directly** - changes will be lost
2. Open an issue describing the problem
3. For urgent fixes, add to `.fernignore` and create a patched version
4. Long-term: contribute to the Fern TypeScript generator

---

## 8. API Reference

### 8.1 Main Classes

| Class | Description |
|-------|-------------|
| `MyOrganizationClient` | Main client for API access |
| `MyOrganizationError` | Base error class |
| `ClientCredentialsTokenProvider` | Server-side token management |

### 8.2 Namespaces

| Namespace | Description |
|-----------|-------------|
| `MyOrganization` | Type namespace for all request/response types |

### 8.3 Resource Endpoints

```typescript
client.organization.members      // Member management
client.organization.roles        // Role management
client.organization.domains      // Domain management
client.organization.invitations  // Invitation management
```

---

---

## 9. Integration with auth0-ui-components

**Impact: HIGH - Understanding the consumption pattern**

The `@auth0/myorganization-js` SDK is consumed by the `auth0-ui-components` monorepo to provide pre-built React components for organization management.

### 9.1 Architecture Overview

```
┌─────────────────────────────────────────────────────────────────┐
│                    auth0-ui-components                          │
├─────────────────────────────────────────────────────────────────┤
│  packages/react/                                                │
│  ├── components/auth0/my-organization/  ← UI Components         │
│  │   ├── domain-table.tsx                                       │
│  │   ├── sso-provider-table.tsx                                 │
│  │   ├── sso-provider-create.tsx                                │
│  │   └── organization-details-edit.tsx                          │
│  │                                                              │
│  └── hooks/my-organization/             ← React Hooks           │
│      ├── use-domain-table.ts            (TanStack Query)        │
│      ├── use-sso-provider-table.ts                              │
│      └── use-config.ts                                          │
├─────────────────────────────────────────────────────────────────┤
│  packages/core/                                                 │
│  ├── auth/core-client.ts                ← Client Factory        │
│  └── services/my-organization/                                  │
│      └── my-organization-api-service.ts ← SDK Initialization    │
├─────────────────────────────────────────────────────────────────┤
│                    @auth0/myorganization-js                     │
│                    (External SDK Dependency)                    │
└─────────────────────────────────────────────────────────────────┘
```

### 9.2 SDK Initialization Pattern

The SDK is initialized in `packages/core/src/services/my-organization/my-organization-api-service.ts`:

```typescript
import { MyOrganizationClient } from '@auth0/myorganization-js';

export function initializeMyOrganizationClient(
  auth: AuthDetails,
  tokenManagerService: ReturnType<typeof createTokenManager>,
): { client: MyOrganizationClient; setLatestScopes: (scopes: string) => void } {
  let latestScopes = '';

  // Proxy mode (server-side token handling)
  if (auth.authProxyUrl) {
    return {
      client: new MyOrganizationClient({
        domain: '',
        baseUrl: `${auth.authProxyUrl}/my-org`,
        fetcher: async (url, init) => {
          return fetch(url, {
            ...init,
            headers: { ...init?.headers, 'auth0-scope': latestScopes },
          });
        },
      }),
      setLatestScopes: (scopes) => { latestScopes = scopes; },
    };
  }

  // Direct mode (client-side token handling)
  return {
    client: new MyOrganizationClient({
      domain: auth.domain,
      fetcher: async (url, init) => {
        const token = await tokenManagerService.getToken(latestScopes, 'my-org');
        return fetch(url, {
          ...init,
          headers: { ...init?.headers, Authorization: `Bearer ${token}` },
        });
      },
    }),
    setLatestScopes: (scopes) => { latestScopes = scopes; },
  };
}
```

### 9.3 Hook Consumption Pattern (TanStack Query)

Hooks in `packages/react/src/hooks/my-organization/` use TanStack Query for caching:

```typescript
// use-domain-table.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';

const domainQueryKeys = {
  all: ['domains'] as const,
  list: () => [...domainQueryKeys.all, 'list'] as const,
  providers: (domainId: string) => [...domainQueryKeys.all, 'providers', domainId] as const,
};

export function useDomainTable(options: UseDomainTableOptions): UseDomainTableResult {
  const { coreClient } = useCoreClient();
  const queryClient = useQueryClient();

  // Query: Fetch domains
  const domainsQuery = useQuery({
    queryKey: domainQueryKeys.list(),
    queryFn: async () => {
      const response = await coreClient!
        .getMyOrganizationApiClient()
        .organization.domains.list();
      return response?.organization_domains ?? [];
    },
    enabled: !!coreClient,
  });

  // Mutation: Create domain
  const createDomainMutation = useMutation({
    mutationFn: async (data: CreateOrganizationDomainRequestContent) => {
      return coreClient!
        .getMyOrganizationApiClient()
        .organization.domains.create(data);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: domainQueryKeys.list() });
    },
  });

  return {
    domains: domainsQuery.data ?? [],
    isFetching: domainsQuery.isLoading,
    onCreateDomain: (data) => createDomainMutation.mutateAsync(data),
    // ...
  };
}
```

### 9.4 Component Consumption Pattern

Components wrap hooks with Higher-Order Components for scope management:

```typescript
// domain-table.tsx
import { withMyOrganizationService } from '@/hoc/with-services';
import { useDomainTable } from '@/hooks/my-organization/use-domain-table';

function DomainTableComponent(props: DomainTableProps) {
  const {
    domains,
    isFetching,
    onCreateDomain,
    onVerifyDomain,
    onDeleteDomain,
  } = useDomainTable({
    createAction: props.createAction,
    deleteAction: props.deleteAction,
    // ...
  });

  return (
    <DataTable columns={columns} data={domains} loading={isFetching} />
  );
}

// HOC ensures required scopes are requested before rendering
export const DomainTable = withMyOrganizationService(
  DomainTableComponent,
  MY_ORGANIZATION_DOMAIN_SCOPES,  // e.g., 'read:domains create:domains delete:domains'
);
```

### 9.5 Key Files in auth0-ui-components

| File | Purpose |
|------|---------|
| `packages/core/src/services/my-organization/my-organization-api-service.ts` | SDK initialization |
| `packages/core/src/auth/core-client.ts` | Client factory with token management |
| `packages/react/src/hooks/my-organization/*.ts` | React hooks with TanStack Query |
| `packages/react/src/components/auth0/my-organization/*.tsx` | UI components |
| `packages/react/src/hoc/with-services.tsx` | HOC for scope management |

### 9.6 SDK API Endpoints Used

| Hook | SDK Methods Called |
|------|-------------------|
| `useDomainTable` | `organization.domains.list()`, `.create()`, `.delete()`, `.verify.create()` |
| `useSsoProviderTable` | `organization.identityProviders.list()`, `.get()`, `.delete()` |
| `useSsoProviderCreate` | `organization.identityProviders.create()` |
| `useSsoProviderEdit` | `organization.identityProviders.update()` |
| `useOrganizationDetailsEdit` | `organization.get()`, `organization.update()` |
| `useIdpConfig` | `organization.identityProviders.domains.create()`, `.delete()` |

### 9.7 Token & Scope Management

The integration uses dynamic scope injection:

```typescript
// Before rendering a component, ensureScopes() is called
await coreClient.ensureScopes(
  'read:domains create:domains',  // Required scopes
  'my-org'                         // Audience path
);

// This updates latestScopes in the SDK client
// The custom fetcher then includes the token with these scopes
```

### 9.8 Error Handling in Components

```typescript
import { MyOrganizationError, BusinessError } from '@auth0/universal-components-core';

const createDomainMutation = useMutation({
  mutationFn: async (data) => {
    // Business logic validation
    if (createAction?.onBefore && !createAction.onBefore(data)) {
      throw new BusinessError({ message: t('domain_create.on_before') });
    }
    // SDK call - may throw MyOrganizationError
    return coreClient!.getMyOrganizationApiClient().organization.domains.create(data);
  },
  onError: (error) => {
    if (error instanceof MyOrganizationError) {
      // Handle API errors (4xx, 5xx)
      toast.error(error.message);
    } else if (error instanceof BusinessError) {
      // Handle validation errors
      toast.warning(error.message);
    }
  },
});
```

---

## References

1. [Auth0 Documentation](https://auth0.com/docs)
2. [SDK Repository](https://github.com/auth0/myorganization-js)
3. [API Reference](https://github.com/auth0/myorganization-js/blob/main/reference.md)
4. [Fern Documentation](https://buildwithfern.com)
5. [Fern Custom Code Guide](https://buildwithfern.com/learn/sdks/overview/custom-code)
6. [TanStack Query Documentation](https://tanstack.com/query/latest)
